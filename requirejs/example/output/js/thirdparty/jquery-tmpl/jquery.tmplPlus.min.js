(function(a){var b=a.tmpl.complete,c=a.fn.domManip;a.tmpl.complete=function(c){var d;b(c);for(d in c)d=c[d],d.addedTmplItems&&a.inArray(d,d.addedTmplItems)===-1&&d.addedTmplItems.push(d);for(d in c)d=c[d],d.rendered&&d.rendered(d)},a.extend({tmplCmd:function(b,c,d){function g(a,b){for(var c=[],d,e,f=b.length,g,h=0,i=a.length;h<i;){g=a[h++];for(e=0;e<f;)d=b[e++],d.data===g&&c.push(d)}return c}var e=[],f;c=a.isArray(c)?c:[c];switch(b){case"find":return g(c,d);case"replace":c.reverse()}a.each(d?g(c,d):c,function(c,g){coll=g.nodes;switch(b){case"update":g.update();break;case"remove":a(coll).remove(),d&&d.splice(a.inArray(g,d),1);break;case"replace":f=f?a(coll).insertBefore(f)[0]:a(coll).appendTo(coll[0].parentNode)[0],e.unshift(g)}});return e}}),a.fn.extend({domManip:function(b,d,e){var f=b[1],g=b[0],h;if(b.length>=2&&typeof f==="object"&&!f.nodeType&&!(f instanceof a)){h=a.makeArray(arguments),h[0]=[a.tmpl(a.template(g),f,b[2],b[3])],h[2]=function(b){a.tmpl.afterManip(this,b,e)};return c.apply(this,h)}return c.apply(this,arguments)}})})(jQuery)